**Outputs**
================================

**Pipeline Outputs**
--------------------

All results are saved in the mounted data directory (/data), regardless
of the pipeline configuration. This ensures that input files,
configuration files, and results are stored together for reproducibility
and traceability.

When running the full pipeline with all modules enabled
(``tools="1,2,3,4,5,6,7,8"``), the ``/data`` directory will contain:

- **Original inputs and configuration files**  
  Raw expression matrices, gene lists, and configuration files  
  (e.g., ``config0``, ``config1``, ``config5``, ``gsea_parameters``).

- **Module-specific output directories**:

  - :ref:`/prepared_gene_lists <out1>` – Gene lists prepared by **Module 1**.  
  - :ref:`/mapped_gene_lists <out2>` – Mapped gene identifier lists generated by **Module 2**.  
  - :ref:`/gprofiler <out34>` – Enrichment results from **Module 3** (g:Profiler plus).  
  - :ref:`/panther <out34>` – Enrichment results from **Module 4** (PANTHER plus).  
  - :ref:`/gsea <out56>` – Input and analysis outputs from **Modules 5 and 6** (GSEA Classic and GSEA Preranked).  
  - :ref:`/plots_and_gene_matrices <out8>` – Time-series enrichment result plots from **Module 8** (Build plots).  
  - :ref:`/annotations <out0>` – Consolidated mapping and term annotation files from **Modules 2–4**,  
    enabling easy cross-referencing of enriched terms and gene memberships.

- **Isoform-filtered expression matrices**  
  Saved if isoform filtering is activated in **Modules 2** or **5**.

.. _out0:

**Mapping and Terms Annotations directory** (``/annotations``)
--------------------------------------------------------------

This directory is created during the first run of the pipeline to keep
the working environment organized and to centralize species-specific
mapping and annotation files. The /annotations directory ensures that
required files are generated once and then reused, avoiding redundant
processing and repeated external queries.

When Modules 2, 3, or 4 are executed, the necessary files are
automatically generated (if missing), saved in /annotations, and reused
in future runs. During execution, modules temporarily copy the required
files into /data, then return them to /annotations once finished. 

.. important::

  **Do not rename these files**, as modules depend on their naming conventions.

**Contents of /annotations**

This directory centralizes all annotation and mapping files generated or used across Modules 2–4.

- **<species_short>_ids_map** (e.g., *mmusculus_ids_map*)  
  Generated and used by **Module 2**.  
  Maps Gene IDs to UniProtKB IDs, Gene Symbols, and official full names.  
  Automatically updated with new unmapped IDs.

- **<species_short>_gprofiler_annotations.gmt** (e.g., *mmusculus_gprofiler_annotations.gmt*)  
  Generated and used by **Module 3**.  
  Contains species-specific gene set annotations from **g:Profiler’s g:GOSt** sources.

- **<species_short>_REAC_annotations** (e.g., *mmusculus_REAC_annotations*)  
  Generated and used by **Module 4**.  
  Provides **Reactome pathway annotations**, obtained directly from the `Reactome Database <https://reactome.org/download-data>`_.

- **<species_short>_PTHR19.0_annotations** (e.g., *mmusculus_PTHR19.0_annotations*)  
  Generated and used by **Module 4**.  
  Contains **PANTHER-specific annotations** downloaded from the official  
  `PANTHER FTP <https://data.pantherdb.org/ftp/sequence_classifications/current_release/PANTHER_Sequence_Classification_files/>`_ resource.

- **<species_short>_gene_uniprot** (e.g., *mmusculus_gene_uniprot*)  
  Generated and used by **Module 4**.  
  Maps **Gene Symbols** to **UniProtKB IDs**, enabling translation of Reactome pathway annotations  
  (which use UniProtKB IDs) into Gene Symbols.  
  Downloaded directly from `UniProt.org <https://www.uniprot.org/api-documentation/uniprotkb#operations-UniProtKB-stream>`_.

.. hint::

  **Recommendation:** Always keep these files in /annotations for reuse.
  This ensures faster runs and consistent annotations across analyses.

.. _out1:

**Module 1 Output Directory** (``/prepared_gene_lists``)
--------------------------------------------------------

The output results from **Module 1** are stored in the directory named
/prepared_gene_lists located in the mounted data directory (/data).

**It includes:**

- **column_header_mapping.txt**  
  A mapping file that explains how columns in the input expression matrix correspond to condition parameters.  
  It lists:

  - **Parameter names**  
  - **Their set values or indexes**  
  - **The matching input matrix column headers**

- **evaluation_report.csv**  
  A summary file containing calculated averages, conditions, and gene evaluations based on the configuration thresholds.  
  It includes the following fields:

  - **Gene ID** — Defined by the ``gene`` variable in the pipeline configuration file (``config0``).  
  - **Calculated Averages** — Stored under columns named ``avgN`` depending on how variables are set in the configuration.  
  - **Calculated Conditions** — Stored under columns named ``condN``.  
  - **Evaluated Genes** — Binary evaluation (``1`` or ``0``) of genes according to expression thresholds  
    defined by ``express_min`` and/or ``express_max``.

- **Select Genes Files** *(one per condition)*  
  These files contain the averages and condition columns for the selected genes.  
  There will be **N files** if N conditions were tested.  
  Filenames are based on the expression threshold parameters:

  - If only ``express_min`` is set → **overexp_condN** *(up-regulated genes)*  
  - If only ``express_max`` is set → **underexp_condN** *(down-regulated genes)*  
  - If both are set → **in_range_condN** *(genes within the specified expression range)*

- **Gene List Files** *(one per condition)*  
  These files contain lists of the selected genes for each condition.  
  There will be **N files** if N conditions were tested.  
  Filenames follow the same threshold logic:

  - If only ``express_min`` is set → **overexp_genes_condN** *(up-regulated genes)*  
  - If only ``express_max`` is set → **underexp_genes_condN** *(down-regulated genes)*  
  - If both are set → **in_range_genes_condN** *(genes within the specified expression range)*

.. Note::

  For more variables details, see the :ref:`Module 1 Details <module1>` section.

.. _out2:

**Module 2 Output Directory** (``/mapped_gene_lists``)
------------------------------------------------------

For each prepared gene list — whether derived from a gene expression matrix,  
a single list specified in the ``gene_list`` variable of ``config0``,  
or located inside ``/prepared_gene_lists`` in ``/data`` — a corresponding  
**four-column TSV file** is generated.

Each line represents one gene and includes:

1. **Gene ID**  
2. **Representative UniProtKB ID**  
3. **Official Gene Symbol**  
4. **Official Full Name**

These mapping files are named after the original input gene lists,  
with the suffix **_map** appended.

.. Note::

  For more variables details, see the :ref:`Module 2 Details <module2>` section.

.. _out34:

**Modules 3 & 4 Output Directories** (``/gprofiler`` and ``/panther``)
------------------------------------------------------------------------

The outputs of **Module 3** (gProfiler plus) and **Module 4** (PANTHER
plus) are stored in the ``/gprofiler`` and ``/panther`` directories,
respectively, within the mounted data directory (/data).

For each mapped gene list located in ``/mapped_gene_lists``,  
the pipeline creates a dedicated subdirectory under the corresponding tool directory:

- ``/data/gprofiler/<gene_list>/results/...``
- ``/data/panther/<gene_list>/results/...``

Within each ``results`` directory, the following files and subdirectories are generated:

**Enrichment Results** (:ref:`gprofiler results fields <table3>`; :ref:`panther results fields <table4>`)

- **short_results.csv** — Simplified summary of key fields  
  (term ID, name, p-value, and source).

- **long_results.csv** — Full enrichment output including  
  term ID, name, description, p-value, precision, recall, source,  
  effective domain size, fold enrichment, hierarchical parent terms, and more.

**Annotations Summary**

- **terms_annotations_results.csv** — Consolidated file listing each enriched term  
  with its ID, name, source, counts of genes (both from the input list and total in term),  
  associated gene IDs and symbols, and the ratio of list genes to total term genes.

**Per-Source Subdirectories**

Each source directory includes:

- CSV result files (**short**, **long**, and **terms_annotations_results**) for that source only.

- **Per-term annotation subdirectories** (stored under ``/<source>/terms_annotations/...``),  
  where each enriched term has its own folder (``.../<TermID_Name>/``) containing:

  - **genes_in_list** — Genes from the initial list associated with the term,  
    including UniProtKB ID, Gene Symbol, and Full Name.

  - **genes_in_term.** — List of all gene symbols annotated to the term (one per line).

  - **uniprots_in_term** — List of all UniProtKB IDs annotated to the term (one per line).

  - **obsolete_or_merged_uniprots** — UniProtKB IDs not found in  
    ``<species_short>_gene_uniprot`` map; corresponds to obsolete or merged UniProtKB entries.

**Directory Structure for g:Profiler and PANTHER results (Modules 3 & 4):**

.. code-block:: text

  /data/gprofiler/ or /data/panther/
  ├── <gene_list>/           # Subdirectory for each mapped gene list
  │   └── results/
  │       ├── short_results.csv
  │       ├── long_results.csv
  │       ├── terms_annotations_results.csv
  │       └── <source>/      # Source-specific results
  │           ├── CSV files (short, long, terms_annotations)
  │           └── terms_annotations/  # Per-term folders
  └── ...

.. _table3:

**gProfiler module results fields found in the short, long and terms annotations results files**

.. table::
  :align: center
  :widths: auto

  +-----------------------+------------------------------------------------+
  | Result Field          | Description                                    |
  +=======================+================================================+
  | TermID (original      | Term ID in its native namespace. For non-GO    |
  | Native)               | terms, the ID is prefixed with the datasource  |
  |                       | abbreviation.                                  |
  +-----------------------+------------------------------------------------+
  | Name                  | Term name.                                     |
  +-----------------------+------------------------------------------------+
  | Description           | Term description if available. If not          |
  |                       | available, repeats the term name.              |
  +-----------------------+------------------------------------------------+
  | P-Value_FDR           | Hypergeometric p-value after FDR multiple      |
  |                       | testing correction                             |
  +-----------------------+------------------------------------------------+
  | Precision             | The proportion of genes in the input list that |
  |                       | are annotated to the function. Defined as      |
  |                       | ListCount/query_size.                          |
  +-----------------------+------------------------------------------------+
  | Recall                | The proportion of functionally annotated genes |
  |                       | that the query recovers. Defined as            |
  |                       | ListCount/term_size.                           |
  +-----------------------+------------------------------------------------+
  | ListCount (original   | The number of genes in the query (list) that   |
  | Intersection_size)    | are annotated to the corresponding term.       |
  +-----------------------+------------------------------------------------+
  | TermCount (original   | The number of genes that are annotated to the  |
  | Term_Size)            | term.                                          |
  +-----------------------+------------------------------------------------+
  | Query_Size\*          | The number of genes that were included in the  |
  |                       | query.                                         |
  |                       |                                                |
  |                       | This might be different from the size of the   |
  |                       | original query list                            |
  +-----------------------+------------------------------------------------+
  | Source                | The abbreviation of the datasource for the     |
  |                       | term. See possible datasources                 |
  +-----------------------+------------------------------------------------+
  | Source_Order          | The numeric order for the term within its      |
  |                       | datasource. Important for drawing reproducible |
  |                       | manhattan plots across different platforms.    |
  +-----------------------+------------------------------------------------+
  | Effective_Domain_Size | The total number of genes “in the universe”    |
  |                       | which is used as one of the four parameters    |
  |                       | for the hypergeometric probability function of |
  |                       | statistical significance.                      |
  +-----------------------+------------------------------------------------+
  | Parents               | List of native IDs that are hierarchically     |
  |                       | above the term. For non-hierarchical           |
  |                       | datasources, points to artificial root node if |
  |                       | applicable.                                    |
  +-----------------------+------------------------------------------------+
  | GroupID               | The identifier that defines the group of terms |
  |                       | that are connected by some previously know     |
  |                       | relations. For example, this as an identifier  |
  |                       | for different Gene Ontology subgraphs that can |
  |                       | be formed from the results based on the        |
  |                       | connections defined in GO.                     |
  +-----------------------+------------------------------------------------+
  | Significant           | Indicator for statistically significant        |
  |                       | results.                                       |
  +-----------------------+------------------------------------------------+
  | Genes_in_list         | The name of the genes in the query that are    |
  |                       | annotated to the corresponding term.           |
  +-----------------------+------------------------------------------------+
  | Genes_in_term         | The name of the genes that are annotated to    |
  |                       | the term.                                      |
  +-----------------------+------------------------------------------------+
  | Ratio (%)             | The ratio is equivalent to the total number of |
  |                       | genes in the initial list associated with a    |
  |                       | given term divided by the number of total gene |
  |                       | annotations of that term, multiplied by 100.   |
  +-----------------------+------------------------------------------------+

**\***\ *\ for more information consult* `<https://biit.cs.ut.ee/gprofiler/page/apis>`_

.. _table4:

**PANTHER module results fields found in the short, long and terms annotations results files**

.. table::
  :align: left
  :widths: auto

  +-------------------+--------------------------------------------------+
  | Result Field      | Description                                      |
  +===================+==================================================+
  | TermID            | Term ID in its native namespace. For non-GO      |
  |                   | terms, the ID is prefixed with the datasource    |
  |                   | abbreviation.                                    |
  +-------------------+--------------------------------------------------+
  | Name              | The Term name.                                   |
  +-------------------+--------------------------------------------------+
  | P-Value           | The raw p-value as determined by Fisher’s exact  |
  |                   | test. This is the probability that the number of |
  |                   | genes you observed in the category occurred by   |
  |                   | chance (randomly), as determined by your         |
  |                   | reference list.                                  |
  +-------------------+--------------------------------------------------+
  | P-Value_FDR       | Hypergeometric p-value after FDR multiple        |
  |                   | testing correction                               |
  +-------------------+--------------------------------------------------+
  | Fold_Enrichment   | The Fold Enrichment of the genes observed in the |
  |                   | query over the expected (number in the query     |
  |                   | divided by the expected number). If it is        |
  |                   | greater than 1, it indicates that the category   |
  |                   | is overrepresented in your experiment.           |
  |                   | Conversely, the category is underrepresented if  |
  |                   | it is less than 1.                               |
  +-------------------+--------------------------------------------------+
  | Plus_minus        | Has either a + or -. A plus sign indicates       |
  |                   | over-representation of this category in your     |
  |                   | experiment: you observed more genes than         |
  |                   | expected based on the reference list (for this   |
  |                   | category, the number of genes in your list is    |
  |                   | greater than the expected value). Conversely, a  |
  |                   | negative sign indicates under-representation.    |
  +-------------------+--------------------------------------------------+
  | Source            | The abbreviation of the datasource for the term. |
  |                   | See possible datasources                         |
  +-------------------+--------------------------------------------------+
  | ListCount         | The number of genes in the query (list) that are |
  | (original         | annotated to the corresponding term.             |
  | Number_in_list)   |                                                  |
  +-------------------+--------------------------------------------------+
  | TermCount         | The number of genes that are annotated to the    |
  | (original         | term.                                            |
  | Number_in_term)   |                                                  |
  +-------------------+--------------------------------------------------+
  | Genes_in_list     | The name of the genes in the query that are      |
  |                   | annotated to the corresponding term.             |
  +-------------------+--------------------------------------------------+
  | Genes_in_term     | The name of the genes that are annotated to the  |
  |                   | term.                                            |
  +-------------------+--------------------------------------------------+
  | Ratio (%)         | The ratio is equivalent to the total number of   |
  |                   | genes in the list associated with a given term   |
  |                   | divided by the number of total gene annotations  |
  |                   | of that term, multiplied by 100.                 |
  +-------------------+--------------------------------------------------+

.. _out56:

**Modules 5 & 6: GSEA Outputs Directory** (``/gsea``)
------------------------------------------------------

The results from **Module 5** (*Prepare GSEA inputs*) and **Module 6** (*GSEA Plus*)  
are stored in the ``/gsea`` directory within the mounted data directory (``/data``).

Module 5 generates all required input files — expression matrices, phenotype class files,  
gene set (GMT) files, ranked lists (RNK), and parameter files —  
while Module 6 executes the Gene Set Enrichment Analysis and produces results.

**Directory Structure (after performing both Classic and Preranked runs)**

- **Input files** — Used to perform enrichment analysis by Module 6, including:
  expression matrices, phenotype labels, GMT files, and parameter files.

- **/gsea/preranked_lists/** — Ranked gene lists prepared for GSEA Preranked.

- **/gsea/results/** — Stores all GSEA output results (Classic and Preranked).

.. note::
  
  Each GSEA run produces its own result subdirectory within ``/results/``: 
  
  - **GSEA Classic:** named as ``<gmt_file>.<phenotype_classes>.GseaClassic``.
  
  - **GSEA Preranked:** named as ``<gmt_file>.<ranked_list>.GseaPreranked``.
  
  - The **gene set file (GMT)** used for the run is always included as a prefix.

**Outputs (per run)**

- **/raw_GSEA_output/** — Contains the original GSEA output, including:
  - HTML visual reports and enrichment plots  
  - Ranked list files  
  - Enrichment statistics and supporting files generated by the native GSEA tool

- **Gene set file (GMT)** — The gene set file used during the enrichment analysis.

**Processed Enrichment Results** (:ref:`gsea results fields <table6>`)

- **short_results.csv** — Simplified summary with key fields  
  (term ID, name, enrichment score, and source).  

- **long_results.csv** — Complete enrichment results including  
  enrichment score (ES), normalized ES (NES), nominal p-value, FDR q-value,  
  rank at maximum enrichment, and leading-edge genes.  

- **terms_annotations_results.csv** — Consolidated file listing each enriched term  
  with its ID, name, source, counts of genes (in input list and total in term),  
  associated gene IDs/symbols, and the ratio of list genes to total term genes.

**Per-Source Subdirectories**

Each source directory contains:

- Source-specific CSV result files (**short**, **long**, and **terms_annotations_results**)

- **Per-term annotation subdirectories** (stored under ``/<source>/terms_annotations/...``),
  where each enriched term has its own folder (``.../<TermID_Name>/``) containing:

  - **genes_in_list** — Genes from the initial list associated with the term  
    (listed as Gene IDs or Gene Symbols, depending on the GMT file used)

  - **genes_in_term** — All genes annotated to the term  
    (Gene IDs or Gene Symbols, depending on the GMT file used)


**Directory Structure (after Classic and Preranked runs):**

.. code-block:: text

   /data/gsea/
   ├── input_files/           # Expression matrices, phenotype labels, GMT, preranked and parameters files
   └── results/
       ├── <run_name>.GseaClassic/
       │   ├── raw_GSEA_output/
       │   ├── short_results.csv
       │   ├── long_results.csv
       │   ├── terms_annotations_results.csv
       │   └── <source>/       # Source-specific results
       │       └── terms_annotations/
       │           └── <TermID_Name>/  # Per-term annotation files
       └── <run_name>.GseaPreranked/
           ├── raw_GSEA_output/
           ├── short_results.csv
           ├── long_results.csv
           ├── terms_annotations_results.csv
           └── <source>/       # Source-specific results
               └── terms_annotations/
                   └── <TermID_Name>/  # Per-term annotation files

.. _table6:

**GSEA module results fields found in the short, long and terms annotations results files**

.. table::
  :align: left
  :widths: auto

  +----------------+-----------------------------------------------------------------------------------------------------+
  | Result Field   | Description                                                                                         |
  +================+=====================================================================================================+
  | Name (original | The Term/Gene Set name                                                                              |
  | GS)            |                                                                                                     |
  +----------------+-----------------------------------------------------------------------------------------------------+
  | Source         | The abbreviation of the datasource for the term                                                     |
  +----------------+-----------------------------------------------------------------------------------------------------+
  | ListCount      | Number of genes in the gene set after filtering out those genes is not in the expression dataset    |
  | (original      |                                                                                                     |
  | Size)          |                                                                                                     |
  +----------------+-----------------------------------------------------------------------------------------------------+
  | ES\*           | `Enrichment                                                                                         |
  |                | score <https://www.gsea-msigdb.org/gsea/doc/GSEAUserGuideTEXT.htm#_Enrichment_Score_(ES)>`__ for    |
  |                | the gene set; degree of overrepresentation at the top or bottom of the ranked gene list             |
  +----------------+-----------------------------------------------------------------------------------------------------+
  | NES\*          | `Normalized enrichment                                                                              |
  |                | score <https://www.gsea-msigdb.org/gsea/doc/GSEAUserGuideTEXT.htm#_Normalized_Enrichment_Score>`__; |
  |                | adjusted across gene sets                                                                           |
  +----------------+-----------------------------------------------------------------------------------------------------+
  | NOM_p-val\*    | `Nominal p value <https://www.gsea-msigdb.org/gsea/doc/GSEAUserGuideTEXT.htm#_Nominal_P_Value>`__   |
  |                | for ES significance (not adjusted)                                                                  |
  +----------------+-----------------------------------------------------------------------------------------------------+
  | FDR_q-val\*    | `False discovery                                                                                    |
  |                | rate <https://www.gsea-msigdb.org/gsea/doc/GSEAUserGuideTEXT.htm#_False_Discovery_Rate>`__;         |
  |                | probability that NES is a false positive                                                            |
  +----------------+-----------------------------------------------------------------------------------------------------+
  | FWER_p-val\*   | Familywise-error rate; conservative false positive estimate                                         |
  +----------------+-----------------------------------------------------------------------------------------------------+
  | RANK-AT-MAX\*  | Rank position where the maximum ES occurs                                                           |
  +----------------+-----------------------------------------------------------------------------------------------------+
  | Leading_edge\* | Stats for the subset of genes contributing the most to ES, `leading edge                            |
  |                | subset <https://www.gsea-msigdb.org/gsea/doc/GSEAUserGuideTEXT.htm#leading_edge_subset>`__:         |
  |                |                                                                                                     |
  |                | - Tags: % of hits before/after ES peak                                                              |
  |                |                                                                                                     |
  |                | - List: % of genes in the ranked list at ES peak                                                    |
  |                |                                                                                                     |
  |                | - Signal: Combined measure of Tags and List (0-100%)                                                |
  +----------------+-----------------------------------------------------------------------------------------------------+
  | Phenotype      | Indicates the side of the enrichment contrast to which the gene set is associated.                  |
  |                |                                                                                                     |
  |                | - **GSEA Classic:** corresponds to the phenotype labels defined in the CLS file. For example, if    |
  |                |   the CLS file specifies Control vs. Treatment, the column will display which phenotype the         |
  |                |   enrichment is biased toward.                                                                      |
  |                |                                                                                                     |
  |                | - **GSEA Preranked:** indicates the enrichment direction relative to the ranking of the gene list.  |
  |                |   A value of **“+”** means enrichment at the top of the ranked list, and **“–”** means enrichment   |
  |                |   at the bottom.                                                                                    |
  +----------------+-----------------------------------------------------------------------------------------------------+
  | Term_Size      | The number of genes that are annotated to the term.                                                 |
  +----------------+-----------------------------------------------------------------------------------------------------+
  | Genes_in_list  | The name of the genes in the query that are annotated to the corresponding term.                    |
  +----------------+-----------------------------------------------------------------------------------------------------+
  | Genes_in_term  | The name of the genes that are annotated to the term.                                               |
  +----------------+-----------------------------------------------------------------------------------------------------+

**\***\ *for more details consult* `GSEA Detailed Enrichment Results <https://www.gsea-msigdb.org/gsea/doc/GSEAUserGuideTEXT.htm#_Detailed_Enrichment_Results>`_

.. _out8:

**Module 8: Build Plots Output Directory** (``/plots_and_gene_matrices``)
-------------------------------------------------------------------------

The results from **Module 8** (*Build Plots*) are stored in the
``/plots_and_gene_matrices`` directory within the mounted data directory (``/data``).

After plotting enrichment results from either **g:Profiler** or **PANTHER**,  
the directory structure is organized by tool and source:

- ``/plots_and_gene_matrices/gprofiler/<source>/``
- ``/plots_and_gene_matrices/panther/<source>/``

For each **source** inside the enrichment results, a corresponding subdirectory
is created under the respective tool directory.

Running this module generates both **tabular reports** and **visual summaries**
for each enriched term, as well as a centralized plots directory (see *Figure 11*).

**Global Output**

- **0_plots/**
  
  Contains all heatmaps and line charts across enriched terms,  
  allowing quick inspection without browsing individual directories.

**Per-Term Directories** (e.g. ``/R-MMU-111996_Ca_dependent_events``)

Each enriched term subdirectory contains the following outputs:

- **Counts Report** (``counts_<TermID>.tsv``)  
  Contains term metadata (*TermID, Name, Source, Term_size*)  
  and the number of genes from the differential lists at each time point.

- **Gene Members Report** (``members_<TermID>.tsv``)  
  Lists the gene names from the differential lists that contribute to the term
  at each time point.

- **Binary Matrix** (``gene_matrix_<TermID>.tsv``)  
  A presence/absence (1/0) matrix showing which genes appear in the term
  across time points.

  - **Second column (#Members):** Total number of genes occurring at that time point (row).  
  - **Last row (Total Occurrences):** Total number of occurrences of each gene
    across all time points.

**Visual Outputs**

- **Line Chart** (``linechart_<TermID_Name_TermCount>.pdf``)  
  Plots the number of associated genes per time point,  
  with separate curves for up- and down-regulated genes (*see Figure 11*).

  **Title format:**  
  ``<TermID> <Name> <Source> <Signal> #<TermCount>``  
  Example:

  ::

      R-MMU-111996 Ca-dependent_events REAC + #27

  - **TermID:** R-MMU-111996  
  - **Name:** Ca-dependent_events  
  - **Source:** REAC  
  - **Signal:** +  
  - **TermCount:** #27

  **Colors:**  
  
  - Up-regulated genes → **blue**  
  
  - Down-regulated genes → **orange**

- **Matrix Heatmap** (``matrix_<TermID_Name_TermCount>.pdf``)  
  Visualizes the binary matrix, highlighting up- and down-regulated
  gene presence across the time series (*see Figure 12*).

  The title follows the same convention as the line chart.  
  Cell colors indicate the contribution of up- (blue) or down- (orange)
  regulated genes for each time point.

.. note::

  All plots and matrices are automatically named according to their **TermID**,
  **Name**, **Source**, and **TermCount**, ensuring traceability
  between plots and enrichment result files.

**Directory structure of /plots_and_gene_matrices**

.. code-block:: text

  /data/plots_and_gene_matrices/
  ├── gprofiler/
  │   ├── REAC/
  │   │   ├── 0_plots/
  │   │   └── R-MMU-111996_Ca_dependent_events/
  │   │       ├── counts_R-MMU-111996.tsv
  │   │       ├── members_R-MMU-111996.tsv
  │   │       ├── gene_matrix_R-MMU-111996.tsv
  │   │       ├── linechart_R-MMU-111996_Ca_dependent_events_#27.pdf
  │   │       └── matrix_R-MMU-111996_Ca_dependent_events_#27.pdf
